version: 0.2

phases:
  install:
    runtime-versions:
      ruby: 3.2
    commands:
      - echo Installing Ruby 3.2.3...
      - sudo apt update
      - sudo apt install git libssl-dev libreadline-dev zlib1g-dev autoconf bison build-essential libyaml-dev libreadline-dev libncurses5-dev libffi-dev libgdbm-dev
      - git clone https://github.com/rbenv/rbenv.git ~/.rbenv
      - echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bashrc
      - echo 'eval "$(rbenv init -)"' >> ~/.bashrc
      - source ~/.bashrc
      - git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
      - rbenv install 3.2.3
      - rbenv global 3.2.3
      - rbenv rehash
      - echo Installing bundler...
      - gem install bundler -v '2.5.6'
      - bundle install
  pre_build:
    commands:
      - echo Commands...
  build:
    commands:
      - echo Running bundle exec rubocop...
      - bundle exec rubocop
      - echo Building the Rails API app...
  post_build:
    commands:
      - echo Build completed on `date`
artifacts:
  files:
    - '**/*'
